impulse.Config.MapWorkshopID = "1185975101"

impulse.Config.MenuCamPos = Vector(1380.803467, 3310.656006, 599.350037)
impulse.Config.MenuCamAng = Angle(11.779953, 31.800583, 0.000000)

impulse.Config.SpawnPos1 = Vector(-1150.7692871094, 2095.2966308594, 1234.2391357422)
impulse.Config.SpawnPos2 = Vector(-5159.873046875, 3580.8022460938, 16.564235687256)

impulse.Config.BroadcastPos = Vector(2718.5314941406, 4057.4865722656, 3416.03125)

impulse.Config.CityCode = "C17"

impulse.Config.BlacklistEnts = {
	["lua_run"] = true,
	["game_text"] = true,
	["item_healthcharger"] = true,
	["item_suitcharger"] = true,
	["trigger_weapon_strip"] = true,
	["npc_turret_ceiling"] = true
}

impulse.Config.Zones = {
	{name = "Trainstation", pos1 = Vector(-1430.1629638672, 3852.6853027344, 1396.4609375), pos2 = Vector(-4958.4423828125, 2319.4990234375, 285.93347167969)},
	{name = "City Ingress", pos1 = Vector(-495.06716918945, 2393.5327148438, 78.705032348633), pos2 = Vector(-1206.76171875, 3862.1860351563, 1430.8989257813)},
	{name = "Plaza Ingress", pos1 = Vector(720.03912353516, 3766.9677734375, 770.2958984375), pos2 = Vector(-400.27896118164, 3159.4372558594, 102.44743347168)},
	{name = "Plaza", pos1 = Vector(722.43969726563, 4724.8642578125, 1383.71484375), pos2 = Vector(2430.4912109375, 3073.2673339844, 120.54026031494)},
	{name = "Plaza Checkpoint", pos1 = Vector(2170.2209472656, 3049.2565917969, 391.8610534668), pos2 = Vector(1787.9787597656, 2377.9262695313, 103.69382476807)},
	{name = "Hospital", pos1 = Vector(790.70037841797, 1899.3322753906, 310.92437744141), pos2 = Vector(1640.4722900391, 481.14428710938, 35.838199615479)},
	{name = "Theatre", pos1 = Vector(3042.0732421875, 1846.4735107422, 84.627540588379), pos2 = Vector(2185.6701660156, 552.33581542969, 561.56567382813)},
	{name = "Terminal Hotel", pos1 = Vector(-354.58343505859, 4672.5639648438, 1135.3695068359), pos2 = Vector(552.44476318359, 3922.341796875, 109.15989685059)},
	{name = "Civil Office Complex", pos1 = Vector(72.936424255371, 3094.3312988281, 102.06623077393), pos2 = Vector(-486.07901000977, 2550.1560058594, 467.6842956543)},
	{name = "Upper Assembly", pos1 = Vector(3964.3664550781, 5645.154296875, 967.75732421875), pos2 = Vector(3461.2404785156, 4096.537109375, 294.43478393555)},
	{name = "Lower Assembly", pos1 = Vector(3586.7553710938, 1149.9997558594, 1179.0739746094), pos2 = Vector(3064.1667480469, 2566.6694335938, 135.55764770508)},
	{name = "Requisitions", pos1 = Vector(-1005.2476806641, 2365.6574707031, 707.35083007813), pos2 = Vector(2944.7836914063, 1985.60546875, 131.60545349121)},
	{name = "North Road", pos1 = Vector(2042.4051513672, 5128.0571289063, 1184.6356201172), pos2 = Vector(3427.3110351563, 4871.5439453125, 290.74411010742)},
	{name = "Ration Distribution Centre", pos1 = Vector(2502.1926269531, 4786.0283203125, 629.04852294922), pos2 = Vector(3388.9965820313, 4308.9208984375, 292.66928100586)},
	{name = "Shell Beach", pos1 = Vector(-3570.6948242188, 8023.0341796875, 2758.775390625), pos2 = Vector(16129.291015625, 16128.91015625, -656.92224121094)},
	{name = "Outer Bulkhead", pos1 = Vector(3848.3168945313, 5651.4560546875, 498.14172363281), pos2 = Vector(3582.0480957031, 7901.4018554688, 292.72424316406)},
	{name = "Fabrication", pos1 = Vector(3972.4770507813, 4726.8598632813, 908.97686767578), pos2 = Vector(5775.0522460938, 4481.4462890625, 272.92810058594)},
	{name = "Grizzly Grotto", pos1 = Vector(5120.1020507813, 4774.0395507813, 669.40881347656), pos2 = Vector(6424.37109375, 5520.15234375, 260.62817382813)},
	{name = "Metropol", pos1 = Vector(3902.0622558594, 2556.3735351563, 1215.9638671875), pos2 = Vector(3610.7233886719, 1742.609375, 3.6063334941864)},
	{name = "APC Garage", pos1 = Vector(1705.3116455078, 6458.8603515625, 303.36569213867), pos2 = Vector(1300.3034667969, 4757.7431640625, 176.52156066895)},
	{name = "Waste Incineration Plant", pos1 = Vector(5014.912109375, 4147.701171875, 517.17614746094), pos2 = Vector(4226.6259765625, 3597.2658691406, 225.07489013672)},
	{name = "Civil Worker Plant", pos1 = Vector(3386.8393554688, 5142.6025390625, 998.31317138672), pos2 = Vector(2761.6416015625, 6005.9067382813, 255.42822265625)},
	{name = "Construction Site", pos1 = Vector(4276.1806640625, 1440.9912109375, 179.46832275391), pos2 = Vector(6644.6567382813, 3190.8598632813, 1869.3879394531)},
	{name = "Abandoned Processing Plant", pos1 = Vector(1761.7663574219, -1838.5847167969, 554.47509765625), pos2 = Vector(3470.4421386719, 531.71875, -180.70111083984)},
	{name = "Lower Nexus", pos1 = Vector(697.07946777344, 4507.560546875, -675.19787597656), pos2 = Vector(3171.7204589844, 1780.3907470703, -366.50933837891)},
	{name = "Nexus", pos1 = Vector(2494.0302734375, 4295.9614257813, 1056.0299072266), pos2 = Vector(3069.5178222656, 2586.4875488281, 38.227142333984)},
	{name = "Upper Nexus", pos1 = Vector(2545.8649902344, 2583.7351074219, 1476.9350585938), pos2 = Vector(3106.1884765625, 4088.427734375, 5257.8002929688)},
	{name = "South Sewers", pos1 = Vector(-3098.0314941406, 164.14768981934, 2.1831855773926), pos2 = Vector(1248.3210449219, 4920.2172851563, -366.80670166016)},
	{name = "North Sewers", pos1 = Vector(6969.4638671875, 639.02795410156, 79.737464904785), pos2 = Vector(3283.4982910156, 6478.9790039063, -529.25720214844)}
}

impulse.Config.IntroScenes = {
	{
	    pos = Vector(2192.0412597656, 3848.9274902344, 3039.6599121094),
     	endpos = Vector(2205.1589355469, 3395.7192382813, 3039.6599121094),
     	posNoLerp = true,
     	posSpeed = 0.05,
	    ang = Angle(1.4019470214844, -175.22178649902, 0),
	    endang = Angle(-34.912124633789, 177.8243560791, 0),
	    fovFrom = 60,
	    fovTo = 94,
     	speed = 0.2,
	    time = 5,
	    text = "Welcome to the City 17 Industrial District.",
     	onStart = function()
        	LocalPlayer():ScreenFade(SCREENFADE.IN, Color(0, 0, 0), 1, 0.1)
     	end,
     	fadeOut = true
    },
	{
		pos = Vector(2390.1274414063, 4948.2817382813, 384.98208618164),
     	endpos = Vector(2678.0747070313, 4965.302734375, 456.45989990234),
     	posSpeed = 0.1,
     	posNoLerp = true,
	    ang = Angle(-11.153659820557, 0.51149892807007, 0),
     	endang = Angle(-13.375009536743, 0.89781904220581, 0),
	    text = "This is a roleplay server set in the Half-Life 2 Universe. You play as an oppressed citizen.",
	    time = 10,
	    fadeIn = true,
	    fadeOut = true
	},
	{
		pos = Vector(2912.8732910156, 2758.6337890625, 3030.9833984375),
	    ang = Angle(20.911111831665, 88.154899597168, 0),
	    endpos = Vector(2901.1027832031, 2802.4157714844, 3439.1896972656),
	    endang = Angle(-27.66863822937, 92.017936706543, 0),
	    posNoLerp = true,
	    posSpeed = 0.1,
	    speed = 0.1,
	    fovFrom = 75,
	    fovTo = 55,
	    fovSpeed = 0.1,
	    text = "An interdimensional empire known commonly as the Combine has taken control of Earth.",
	    time = 13.5,
	    fadeIn = true,
	    fadeOut = true
	},
	{
	    pos = Vector(2438.4790039063, 3677.5034179688, -203.09471130371),
	    endpos = Vector(2549.0437011719, 3827.8190917969, -167.09471130371),
	    posNoLerp = true,
	    posSpeed = 0.092,
	    ang = Angle(17.627307891846, 149.28977966309, 0),
	    text = "Metropolice and trans-human OTA units uphold the Combine's rule and squash civil resistance.",
	    time = 11,
	    fadeIn = true,
	    fadeOut = true
	},
	{
		pos = Vector(3228.2243652344, 4426.2797851563, 415.69180297852),
     	endpos = Vector(3055.4653320313, 4393.1123046875, 399.84503173828),
	    ang = Angle(21.876817703247, -129.53663635254, 0),
     	endang = Angle(20.041788101196, -55.363834381104, 0),
	    text = "Tokens and food rationed by the Combine are supplied at ration dispensers around the city.",
     	speed = 0.15,
	    time = 9.5,
	    fadeIn = true,
	    fadeOut = true
	},
	{
	    pos = Vector(3234.205078125, 5460.7192382813, 357.88122558594),
	    endpos = Vector(3130.3693847656, 5369.8588867188, 376.42010498047),
	    ang = Angle(5.0718064308167, 22.914667129517, 0),
	    endang = Angle(-10.960467338562, 97.280906677246, 0),
	    posSpeed = 0.18,
	    speed = 0.2,
	    fovFrom = 78,
	    fovTo = 82,
	    fovSpeed = 0.01,
	    text = "You can choose to join the Civil Workers Union and sell food, setup businesses or become a doctor.",
	    time = 10,
	    fadeIn = true,
	    fadeOut = true
	},
	{
		pos = Vector(208.09274291992, 4483.025390625, 1040.66796875),
		endpos = Vector(208.2241973877, 4477.4326171875, 721.21838378906),
		ang = Angle(89, -88.53897857666, 0),
		endang = Angle(89, 89.601470947266, 0),
		posSpeed = 0.1,
		speed = 0.1,
		text = "You can also purchase an apartment or property, decorate it or use it to store items.",
		time = 10,
	    fadeIn = true,
	    fadeOut = true
	},
	{ -- out of sync a bit
	    pos = Vector(8456.953125, 9063.96875, 607.52703857422),
	    endpos = Vector(8371.02734375, 8875.0048828125, 657.33618164063),
	    ang = Angle(4.1062116622925, 118.28520965576, 0),
	    endang = Angle(11.349680900574, 145.81045532227, 0),
	    posSpeed = 0.1,
	    posNoLerp = true,
	    speed = 0.15,
	    fovFrom = 52,
	    fovTo = 71,
	    fovSpeed = 0.14,
	    text = "If you wish to revolt, you may join the resistance, however it is no easy task...",
	    time = 12,
	    fadeIn = true,
	    fadeOut = true
	},
	{
	    pos = impulse.Config.MenuCamPos,
	    ang = impulse.Config.MenuCamAng,
	    fovFrom = 40,
	    fovSpeed = 0.2,
	    time = 13,
	    text = "Welcome to impulse: Half-Life 2 Roleplay.",
	    static = true,
	    fadeIn = true,
	    onStart = function()
	    	CHAR_MUSIC = CreateSound(LocalPlayer(), "music/hl2_song2.mp3")
	    	CHAR_MUSIC:SetSoundLevel(0)
	    	CHAR_MUSIC:ChangeVolume(1.5)
	    	CHAR_MUSIC:ChangePitch(70)
	    	CHAR_MUSIC:Play()
	    end
	}
}

impulse.Config.ScannerSpawnPos = Vector(2413.6547851563, 3128.5007324219, 763.32086181641)

impulse.Config.DealerLocations = {
	{pos = Vector(4719.53125, 8009.875, 320.03125), ang = Angle(0, 98.61328125, 0)},
	{pos = Vector(2734.5625, 1959.09375, -135.96875), ang = Angle(0, -129.7705078125, 0)},
	{pos = Vector(6254.875, 3753.9375, -23.96875), ang = Angle(0, -178.0224609375, 0)},
	{pos = Vector(6524.46875, 2294.75, 224.03125), ang = Angle(0, -142.9541015625, 0)}
}

impulse.Config.FishermanPos = Vector(-1769.53125, 9546.59375, 204.25)
impulse.Config.FishermanAng = Angle(0, -33.310546875, 0)

impulse.Config.PrisonAngle = Angle(1.4399926662445, -178.77975463867, 0)
impulse.Config.PrisonCells = {
	Vector(2652.556640625, 3765.2084960938, -303.96875),
	Vector(2651.4819335938, 3946.5244140625, -303.96875),
	Vector(2650.3229980469, 4142.0708007813, -303.96875)
}

impulse.Config.JWButtonPos = Vector(2768.0625, 3977.96875, 3611)
impulse.Config.JWOffButtonPos = Vector(2771.40625, 3975.75, 3584)
impulse.Config.AJButtonPos = Vector(2768.0625, 3977.96875, 3611)
impulse.Config.AJOffButtonPos = Vector(2768.0625, 3977.96875, 3611)

impulse.Config.Buttons = {
	{
		desc = "Turn on Judgement Wavier",
		pos = impulse.Config.JWButtonPos,
		customCheck = function(ply, button)

			return false
		end
	},
	{
		desc = "Turn off Judgement Wavier",
		pos = impulse.Config.JWOffButtonPos,
		customCheck = function(ply, button)
			return false
		end
	},
	{
		desc = "Warehouse 3 Announcement",
		pos = Vector(3208, 5577, 874),
		doorgroup = 1
	},
	{
		desc = "Ration Offline Announcement",
		pos = Vector(2827, 4249, 430),
		customCheck = function(ply)
			return ply:IsAdmin()
		end
	},
	{
		desc = "Ration Online Announcement",
		pos = Vector(2809, 4249, 430),
		customCheck = function(ply)
			return ply:IsAdmin()
		end
	},
	{
		desc = "Ration Door Lock",
		pos = Vector(3007.3369140625, 4747.5991210938, 377),
		customCheck = function(ply)
			return ply:IsAdmin()
		end
	},
	{
		desc = "Lockdown Off",
		pos = Vector(2846.21875, 4013.09375, 3584),
		doorgroup = 2
	},
	{
		desc = "Lockdown On",
		pos = Vector(2846.5, 4017.09375, 3611),
		doorgroup = 2
	},
	{
		desc = "Bulhead Close",
		pos = Vector(2887.3125, 4000.53125, 3584),
		doorgroup = 2
	},
	{
		desc = "Bulhead Open",
		pos = Vector(2889.6875, 4003.78125, 3611),
		doorgroup = 2
	},
}

impulse.Config.ApartmentBlocks = {
	{
		name = "Terminal Hotel",
		apartments = {
			{name = "101", doors = {923, 922}},
			{name = "102", doors = {918}},
			{name = "103", doors = {919}},
			{name = "104", doors = {920, 921}},
			{name = "201", doors = {917, 916}},
			{name = "202", doors = {912}},
			{name = "203", doors = {913}},
			{name = "204", doors = {914, 915}},
			{name = "301", doors = {911, 910}},
			{name = "302", doors = {906}},
			{name = "303", doors = {907}},
			{name = "304", doors = {908, 909}},
			{name = "401", doors = {902, 905}},
			{name = "402", doors = {900}},
			{name = "403", doors = {901}},
			{name = "404", doors = {903, 904}}
		}
	},
	{
		name = "Diordna Hotel",
		apartments = {
			{name = "101", doors = {279, 845, 846}},
			{name = "102", doors = {927, 928, 929}},
			{name = "201", doors = {930, 934, 935}},
			{name = "202", doors = {931, 932, 933}}
		}
	}
}

impulse.Config.NPCSpawns = {
	{type = "antlion", dist = 1000, pos = Vector(11970.2421875, 10264.162109375, -58.081539154053), ang = Angle(24.530891418457, -59.068607330322, 0)},
	{type = "antlion", dist = 2000, pos = Vector(10502.428710938, 10893.104492188, -52.467422485352), ang = Angle(-6.9615392684937, 16.951498031616, 0)},
	{type = "zombie", dist = 1000, pos = Vector(11873.702148438, 9825.083984375, -52.990062713623), ang = Angle(169.24647521973, 3.3798696994781, 0)}
	--{Type = "antlion_boss", Key = "bigjim", LifeTime = 1500, Manual = true, Pos = Vector()}
}

impulse.Config.LoadScript = function()
	for v,k in pairs(ents.FindByClass("prop_dynamic")) do
		if k:GetModel() == "models/props_interiors/vendingmachinesoda01a.mdl" then
			local pos, ang = k:GetPos(), k:GetAngles()
			k:Remove()

			local new = ents.Create("impulse_hl2rp_vendingmachine")
			new:SetPos(pos)
			new:SetAngles(ang)
			new:Spawn()

			local phys = new:GetPhysicsObject()

			if phys and phys:IsValid() then
				phys:EnableMotion(false)
			end
		end
	end

	for v,k in pairs(ents.FindByClass("npc_combine_camera")) do
		if k:MapCreationID() != -1 then
			local pos = k:GetPos()
			local ang = k:GetAngles()
			local values = k:GetKeyValues()

			k:Remove()

			local new = ents.Create("npc_combine_camera")
			new:SetPos(pos)
			new:SetAngles(ang)
			new:Spawn()
			new:Activate()

			new:SetKeyValue("innerradius", values.outerradius)
			new:SetKeyValue("outerradius", values.outerradius)
		end
	end

	-- get rid of abusable radios
	for v,k in pairs(ents.FindByClass("prop_physics")) do
		if k:GetModel() == "models/props_lab/citizenradio.mdl" then
			local phys = k:GetPhysicsObject()
			if IsValid(phys) then
				phys:EnableMotion(false)
				phys:Sleep()
			end
		end
	end

	hook.Add("PlayerCanHearCheck", "impulseHL2RPCanHearTheatre", function(listener, speaker)
		if speaker:GetPos():WithinAABox(Vector(2294.3627929688, 720.26623535156, 354.81311035156), Vector(3009.0051269531, 957.97796630859, 47.19352722168)) and listener:GetPos():WithinAABox(Vector(2965.8940429688, 1498.8292236328, -143.17835998535), Vector(2152.6481933594, 528.80187988281, 491.6174621582)) then
			listener.CanHear[speaker] = true
		end
	end)
end

hook.Remove("InitPostEntity", "APEX-INDST-LOAD") -- this map has a weird lua hook that breaks stuff i think i added it idk why
