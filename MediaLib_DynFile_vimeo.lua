local a=medialib.load("oop")local b=a.class("VimeoService","HTMLService")b.identifier="vimeo"local c={"https?://www.vimeo.com/([0-9]+)","https?://vimeo.com/([0-9]+)","https?://www.vimeo.com/channels/staffpicks/([0-9]+)","https?://vimeo.com/channels/staffpicks/([0-9]+)"}function b:parseUrl(d)for e,f in pairs(c)do local g=string.match(d,f)if g then return{id=g}end end end;function b:isValidUrl(d)return self:parseUrl(d)~=nil end;local h="http://wyozi.github.io/gmod-medialib/vimeo.html?id=%s"function b:resolveUrl(d,i)local j=self:parseUrl(d)local k=string.format(h,j.id)i(k,{start=j.start})end;function b:directQuery(d,i)local j=self:parseUrl(d)local l=string.format("http://vimeo.com/api/v2/video/%s.json",j.id)http.Fetch(l,function(m,n,o,p)if n==0 then i("http body size = 0")return end;if p==404 then i("Invalid id")return end;local q={}q.id=j.id;local r=util.JSONToTable(m)if r then q.title=r[1].title;q.duration=r[1].duration else q.title="ERROR"end;i(nil,q)end,function(s)i("HTTP: "..s)end)end;function b:hasReliablePlaybackEvents()return true end;return b
